<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Videollamadas Admin y Usuario</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
            background-color: #f0f0f0;
        }

        #login-form, #video-container {
            display: none;
        }

        #login-form.active, #video-container.active {
            display: block;
        }

        #video-container {
            display: flex;
            flex-direction: row;
            gap: 10px;
        }

        video {
            width: 400px;
            height: 300px;
            border: 1px solid #ccc;
            background: black;
        }

        button {
            margin: 10px;
            padding: 10px 20px;
            font-size: 16px;
        }

        h2 {
            color: #333;
        }
    </style>
</head>
<body>

    <div id="login-form" class="active">
        <h2>Iniciar sesión</h2>
        <form id="form">
            <label for="role">Seleccione su rol:</label><br>
            <input type="radio" name="role" value="admin" required> Administrador <br>
            <input type="radio" name="role" value="user" required> Usuario <br><br>

            <label for="code">Contraseña:</label>
            <input type="password" id="code" required><br><br>
            <button type="submit">Iniciar Sesión</button>
        </form>
    </div>

    <div id="video-container">
        <h2>Videollamada</h2>
        <div id="admin-video-container">
            <h3>Administrador</h3>
            <video id="admin-video" autoplay playsinline></video>
        </div>

        <div id="user-video-container">
            <h3>Usuario</h3>
            <video id="user-video" autoplay playsinline></video>
        </div>
    </div>

    <script>
        // Variables de contraseñas
        const adminCode = "1234";
        const userCode = "0987";

        // Obtener referencias a los elementos del DOM
        const form = document.getElementById("form");
        const codeInput = document.getElementById("code");
        const videoContainer = document.getElementById("video-container");
        const loginForm = document.getElementById("login-form");
        const adminVideo = document.getElementById("admin-video");
        const userVideo = document.getElementById("user-video");
        let role = "";

        // Evento de inicio de sesión
        form.addEventListener("submit", function (e) {
            e.preventDefault();
            const code = codeInput.value;
            role = document.querySelector('input[name="role"]:checked').value;

            // Verificar contraseña del administrador o del usuario
            if ((role === "admin" && code === adminCode) || (role === "user" && code === userCode)) {
                loginForm.classList.remove("active");
                videoContainer.classList.add("active");
                startVideo(role);
            } else {
                alert("Contraseña incorrecta.");
            }
        });

        // Función para iniciar el acceso a la cámara
        function startVideo(role) {
            navigator.mediaDevices.getUserMedia({ video: true, audio: true })
                .then(function (stream) {
                    if (role === "admin") {
                        adminVideo.srcObject = stream;
                    } else if (role === "user") {
                        userVideo.srcObject = stream;
                    }
                })
                .catch(function (err) {
                    console.error("Error al acceder a la cámara o micrófono: ", err);
                });
        }
    </script>

</body>
</html>
