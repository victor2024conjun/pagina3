<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Videollamadas - Solo Administrador</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
            background-color: #f0f0f0;
        }

        #login-form, #video-section {
            display: none;
        }

        #login-form.active, #video-section.active {
            display: block;
        }

        video {
            width: 600px;
            height: 400px;
            border: 1px solid #ccc;
            background: black;
        }

        button {
            margin: 10px;
            padding: 10px 20px;
            font-size: 16px;
        }

        .error {
            color: red;
        }
    </style>
</head>
<body>

    <div id="login-form" class="active">
        <h2>Iniciar sesión como Administrador</h2>
        <form id="form">
            <label for="password">Contraseña:</label>
            <input type="password" id="password" required><br><br>
            <button type="submit">Iniciar Sesión</button>
        </form>
        <p id="error-msg" class="error"></p>
    </div>

    <div id="video-section">
        <h2>Videollamada (Administrador)</h2>
        <video id="video" autoplay playsinline></video><br>
        <button id="end-call">Finalizar Videollamada</button>
    </div>

    <script>
        const adminPassword = "1234"; // Contraseña del administrador
        const form = document.getElementById("form");
        const passwordInput = document.getElementById("password");
        const loginForm = document.getElementById("login-form");
        const videoSection = document.getElementById("video-section");
        const video = document.getElementById("video");
        const errorMsg = document.getElementById("error-msg");
        let mediaStream;

        // Evento de autenticación del administrador
        form.addEventListener("submit", function (e) {
            e.preventDefault();
            const password = passwordInput.value;

            if (password === adminPassword) {
                loginForm.classList.remove("active");
                videoSection.classList.add("active");
                errorMsg.textContent = "";
                startVideo();
            } else {
                errorMsg.textContent = "Contraseña incorrecta. Inténtalo de nuevo.";
            }
        });

        // Función para iniciar la videollamada
        function startVideo() {
            navigator.mediaDevices.getUserMedia({ video: true, audio: true })
                .then(function (stream) {
                    mediaStream = stream;
                    video.srcObject = stream;
                })
                .catch(function (err) {
                    console.error("Error al acceder a la cámara o micrófono: ", err);
                });
        }

        // Finalizar videollamada
        document.getElementById("end-call").addEventListener("click", function () {
            if (mediaStream) {
                mediaStream.getTracks().forEach(track => track.stop()); // Detener la transmisión de cámara y micrófono
                video.srcObject = null;
                alert("Videollamada finalizada.");
                loginForm.classList.add("active");
                videoSection.classList.remove("active");
            }
        });
    </script>

</body>
</html>
